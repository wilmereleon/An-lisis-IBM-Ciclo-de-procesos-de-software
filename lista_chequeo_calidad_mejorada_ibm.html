<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Chequeo de Calidad - IBM QMS</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚úì</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'IBM Plex Sans', sans-serif;
            background: linear-gradient(135deg, #0f62fe 0%, #0353e9 100%);
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #161616 0%, #262626 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .instructions {
            background: #f0f7ff;
            border-left: 4px solid #0f62fe;
            padding: 1.5rem;
            margin: 2rem;
            border-radius: 8px;
        }

        .instructions h3 {
            color: #0f62fe;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .instructions ul {
            margin-left: 1.5rem;
            line-height: 1.8;
        }

        .instructions li {
            margin-bottom: 0.5rem;
            color: #393939;
        }

        .scale-legend {
            background: #fff4e6;
            border-left: 4px solid #ff8c00;
            padding: 1.5rem;
            margin: 0 2rem 2rem 2rem;
            border-radius: 8px;
        }

        .scale-legend h3 {
            color: #ff8c00;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .scale-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .scale-item {
            background: white;
            padding: 1rem;
            border-radius: 6px;
            border: 2px solid #e0e0e0;
        }

        .scale-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #0f62fe;
            margin-bottom: 0.5rem;
        }

        .scale-label {
            font-size: 0.9rem;
            color: #525252;
        }

        .metrics-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            padding: 2rem;
            background: #f4f4f4;
        }

        .metric-card {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #e0e0e0;
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #0f62fe;
            margin-bottom: 0.5rem;
        }

        .metric-label {
            color: #525252;
            font-size: 0.9rem;
        }

        .content {
            padding: 2rem;
        }

        .category-section {
            margin-bottom: 3rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }

        .category-header {
            background: linear-gradient(135deg, #0f62fe 0%, #0353e9 100%);
            color: white;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
        }

        .category-header:hover {
            background: linear-gradient(135deg, #0353e9 0%, #002d9c 100%);
        }

        .category-title {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .category-score {
            font-size: 1.2rem;
            font-weight: 500;
        }

        .category-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }

        .category-content.active {
            max-height: 10000px;
            padding: 2rem;
        }

        .checklist-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            overflow: hidden;
        }

        .checklist-table thead {
            background: #161616;
            color: white;
        }

        .checklist-table th {
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.95rem;
            border-bottom: 2px solid #0f62fe;
        }

        .checklist-table tbody tr {
            border-bottom: 1px solid #e0e0e0;
            transition: background 0.2s;
        }

        .checklist-table tbody tr:hover {
            background: #f4f4f4;
        }

        .checklist-table td {
            padding: 1.25rem 1rem;
            vertical-align: top;
        }

        .attribute-cell {
            font-weight: 500;
            color: #161616;
            min-width: 250px;
        }

        .attribute-description {
            font-size: 0.85rem;
            color: #525252;
            margin-top: 0.25rem;
        }

        .scale-cell {
            min-width: 400px;
        }

        .scale-options {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .scale-option {
            padding: 0.5rem 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.85rem;
            background: white;
        }

        .scale-option:hover {
            border-color: #0f62fe;
            background: #d0e2ff;
        }

        .scale-option.selected {
            background: #0f62fe;
            color: white;
            border-color: #0f62fe;
        }

        .observation-cell {
            min-width: 200px;
        }

        .observation-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 0.85rem;
            font-family: 'IBM Plex Sans', sans-serif;
            resize: vertical;
            min-height: 60px;
        }

        .observation-input:focus {
            outline: 2px solid #0f62fe;
            border-color: #0f62fe;
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 2rem;
            padding: 2rem;
        }

        .btn {
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: #0f62fe;
            color: white;
        }

        .btn-primary:hover {
            background: #0353e9;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(15, 98, 254, 0.3);
        }

        .btn-success {
            background: #24a148;
            color: white;
        }

        .btn-success:hover {
            background: #198038;
        }

        .btn-secondary {
            background: #393939;
            color: white;
        }

        .btn-secondary:hover {
            background: #262626;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            /* Ocultar elementos de navegaci√≥n y botones */
            #ibm-top-navbar,
            .nav-buttons,
            button:not(.scale-option) {
                display: none !important;
            }

            /* Mantener scale-options visibles con valores seleccionados */
            .scale-option {
                display: inline-block !important;
                padding: 4px 8px;
                font-size: 10px;
                border: 1px solid #c6c6c6 !important;
                background: white !important;
                print-color-adjust: exact;
                -webkit-print-color-adjust: exact;
            }

            .scale-option.selected {
                background: #0f62fe !important;
                color: white !important;
                border-color: #0f62fe !important;
                font-weight: 600;
                print-color-adjust: exact;
                -webkit-print-color-adjust: exact;
            }

            /* Expandir todo el contenido */
            .category-content {
                max-height: none !important;
                padding: 1rem;
                page-break-inside: avoid;
            }

            /* Tablas y filas de atributos */
            .attribute-row {
                page-break-inside: avoid;
                border: 1px solid #e0e0e0;
                padding: 8px;
                margin-bottom: 8px;
            }

            /* Labels de atributos */
            .attribute-label {
                font-weight: 600;
                font-size: 11px;
                margin-bottom: 4px;
            }

            .attribute-description {
                font-size: 9px;
                color: #525252;
                margin-bottom: 8px;
            }

            /* Observaciones */
            .observation-input {
                border: 1px solid #c6c6c6 !important;
                border-radius: 0;
                padding: 6px;
                font-size: 9px;
                min-height: 40px;
                page-break-inside: avoid;
            }

            /* Headers de categor√≠as */
            .category-header {
                background: #f4f4f4 !important;
                print-color-adjust: exact;
                -webkit-print-color-adjust: exact;
                page-break-after: avoid;
                border: 2px solid #0f62fe !important;
            }

            /* Dashboard de m√©tricas */
            .dashboard {
                page-break-before: avoid;
                page-break-after: avoid;
                border: 2px solid #0f62fe;
                padding: 12px;
            }

            .metric-card {
                break-inside: avoid;
                border: 1px solid #e0e0e0;
                padding: 8px;
            }

            /* Instrucciones */
            .instructions,
            .scale-legend {
                page-break-inside: avoid;
                font-size: 10px;
            }

            /* Header principal */
            .header {
                page-break-after: avoid;
                margin-bottom: 16px;
            }

            /* Ajustar m√°rgenes de p√°gina */
            @page {
                margin: 1.5cm;
                size: A4;
            }

            /* Asegurar que scale-options no se corten */
            .scale-options {
                page-break-inside: avoid;
                display: flex !important;
                flex-wrap: wrap !important;
                gap: 4px !important;
            }
        }

        @media (max-width: 1200px) {
            .scale-options {
                flex-direction: column;
            }

            .scale-option {
                width: 100%;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- IBM Navigation Module -->
    <script src="ibm-navigation.js"></script>
    
    <div class="container">
        <div class="header">
            <h1>üìã Lista de Chequeo de Calidad de Software</h1>
            <p>IBM Quality Management System - Evaluaci√≥n Integral por Categor√≠as</p>
            <p style="font-size: 0.9rem; margin-top: 0.5rem;">Conforme a CMMI Level 3, TMMi Level 3, IEEE 829, ISO/IEC 25010</p>
        </div>

        <div class="instructions">
            <h3>üìñ Instrucciones de Uso</h3>
            <ul>
                <li><strong>Prop√≥sito:</strong> Evaluar la calidad de cada fase del ciclo de desarrollo mediante atributos espec√≠ficos agrupados por categor√≠as</li>
                <li><strong>Evaluaci√≥n:</strong> Para cada atributo, seleccione el valor de la escala que mejor describe el estado actual</li>
                <li><strong>Escalas:</strong> Cada atributo tiene una escala espec√≠fica (1-5, S√≠/No, Porcentaje, o Cantidad) seg√∫n el contexto</li>
                <li><strong>Observaciones:</strong> Documente hallazgos espec√≠ficos, defectos identificados o acciones correctivas necesarias</li>
                <li><strong>Interpretaci√≥n:</strong> Los puntajes se agregan por categor√≠a para obtener m√©tricas de calidad globales</li>
                <li><strong>Uso de datos:</strong> Los datos recolectados sirven para estimar esfuerzos de correcci√≥n, medir avance y establecer tendencias</li>
            </ul>
        </div>

        <div class="scale-legend">
            <h3>üìä Escalas de Evaluaci√≥n Unificadas</h3>
            <div class="scale-grid">
                <div class="scale-item">
                    <div class="scale-value">1-5</div>
                    <div class="scale-label">Escala Cualitativa<br>1=Muy Deficiente, 5=Excelente</div>
                </div>
                <div class="scale-item">
                    <div class="scale-value">S√≠/No</div>
                    <div class="scale-label">Cumplimiento Binario<br>Para atributos absolutos</div>
                </div>
                <div class="scale-item">
                    <div class="scale-value">0-100%</div>
                    <div class="scale-label">Porcentaje de Cumplimiento<br>Para mediciones proporcionales</div>
                </div>
                <div class="scale-item">
                    <div class="scale-value">Cantidad</div>
                    <div class="scale-label">Conteo Num√©rico<br>Para defectos o elementos</div>
                </div>
            </div>
        </div>

        <div class="metrics-summary">
            <div class="metric-card">
                <div class="metric-value" id="total-score">0%</div>
                <div class="metric-label">Calidad Global</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="completed-attrs">0</div>
                <div class="metric-label">Atributos Evaluados</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="defects-count">0</div>
                <div class="metric-label">Defectos Identificados</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="avg-score">0</div>
                <div class="metric-label">Puntaje Promedio</div>
            </div>
        </div>

        <div class="content">
            <!-- CATEGOR√çA 1: REQUERIMIENTOS -->
            <div class="category-section">
                <div class="category-header" onclick="toggleCategory('requirements')">
                    <div class="category-title">
                        <span>üìù</span>
                        <span>Categor√≠a 1: Calidad de Requerimientos</span>
                    </div>
                    <div class="category-score" id="requirements-score">0%</div>
                </div>
                <div class="category-content active" id="requirements-content">
                    <table class="checklist-table">
                        <thead>
                            <tr>
                                <th style="width: 25%;">Atributo a Evaluar</th>
                                <th style="width: 45%;">Escala de Medici√≥n</th>
                                <th style="width: 30%;">Observaciones/Hallazgos</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-category="requirements">
                                <td class="attribute-cell">
                                    <strong>¬øSon los requerimientos compatibles?</strong>
                                    <div class="attribute-description">Los requerimientos no deben entrar en conflicto entre s√≠ ni con restricciones del sistema</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="1" onclick="selectOption(this)">1 - Totalmente incompatibles</div>
                                        <div class="scale-option" data-value="2" onclick="selectOption(this)">2 - La mayor√≠a incompatibles</div>
                                        <div class="scale-option" data-value="3" onclick="selectOption(this)">3 - Mitad incompatibles</div>
                                        <div class="scale-option" data-value="4" onclick="selectOption(this)">4 - Pocos incompatibles</div>
                                        <div class="scale-option" data-value="5" onclick="selectOption(this)">5 - Todos compatibles</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: Requerimiento REQ-015 conflicta con REQ-023 en l√≥gica de negocio..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="requirements">
                                <td class="attribute-cell">
                                    <strong>¬øSon los requerimientos completos?</strong>
                                    <div class="attribute-description">Todos los casos de uso, flujos alternativos y excepciones est√°n documentados</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="0" onclick="selectOption(this)">0-25% - Muy incompleto</div>
                                        <div class="scale-option" data-value="1" onclick="selectOption(this)">26-50% - Incompleto</div>
                                        <div class="scale-option" data-value="2" onclick="selectOption(this)">51-75% - Parcialmente completo</div>
                                        <div class="scale-option" data-value="3" onclick="selectOption(this)">76-90% - Mayormente completo</div>
                                        <div class="scale-option" data-value="4" onclick="selectOption(this)">91-100% - Completamente completo</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: Faltan especificar flujos de error en m√≥dulo de pagos..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="requirements">
                                <td class="attribute-cell">
                                    <strong>¬øSon los requerimientos claros?</strong>
                                    <div class="attribute-description">Redacci√≥n sin ambig√ºedades, comprensible para stakeholders t√©cnicos y de negocio</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="1" onclick="selectOption(this)">1 - Muy ambiguos</div>
                                        <div class="scale-option" data-value="2" onclick="selectOption(this)">2 - Ambiguos</div>
                                        <div class="scale-option" data-value="3" onclick="selectOption(this)">3 - Moderadamente claros</div>
                                        <div class="scale-option" data-value="4" onclick="selectOption(this)">4 - Claros</div>
                                        <div class="scale-option" data-value="5" onclick="selectOption(this)">5 - Muy claros</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: T√©rminos t√©cnicos no definidos en glosario..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="requirements">
                                <td class="attribute-cell">
                                    <strong>¬øSon los requerimientos medibles?</strong>
                                    <div class="attribute-description">Existen criterios cuantificables para verificar el cumplimiento</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="yes" onclick="selectOption(this)">‚úì S√≠ - Todos medibles</div>
                                        <div class="scale-option" data-value="partial" onclick="selectOption(this)">~ Parcial - Algunos medibles</div>
                                        <div class="scale-option" data-value="no" onclick="selectOption(this)">‚úó No - No medibles</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: Falta definir SLA de tiempo de respuesta..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="requirements">
                                <td class="attribute-cell">
                                    <strong>¬øSon los requerimientos alcanzables?</strong>
                                    <div class="attribute-description">Factibles t√©cnica y econ√≥micamente con recursos y tiempo disponible</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="1" onclick="selectOption(this)">1 - Inalcanzables</div>
                                        <div class="scale-option" data-value="2" onclick="selectOption(this)">2 - Dif√≠cilmente alcanzables</div>
                                        <div class="scale-option" data-value="3" onclick="selectOption(this)">3 - Alcanzables con riesgo</div>
                                        <div class="scale-option" data-value="4" onclick="selectOption(this)">4 - Alcanzables</div>
                                        <div class="scale-option" data-value="5" onclick="selectOption(this)">5 - F√°cilmente alcanzables</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: Requiere tecnolog√≠a no disponible actualmente..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="requirements">
                                <td class="attribute-cell">
                                    <strong>Cantidad de requerimientos con defectos</strong>
                                    <div class="attribute-description">Contar requerimientos que requieren correcci√≥n para estimaci√≥n de esfuerzo</div>
                                </td>
                                <td class="scale-cell">
                                    <input type="number" class="observation-input" placeholder="Ingrese cantidad num√©rica" style="width: 150px; min-height: 40px;" onchange="updateMetrics()">
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: IDs: REQ-012, REQ-034, REQ-078..."></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- CATEGOR√çA 2: DISE√ëO -->
            <div class="category-section">
                <div class="category-header" onclick="toggleCategory('design')">
                    <div class="category-title">
                        <span>üé®</span>
                        <span>Categor√≠a 2: Calidad de Dise√±o</span>
                    </div>
                    <div class="category-score" id="design-score">0%</div>
                </div>
                <div class="category-content" id="design-content">
                    <table class="checklist-table">
                        <thead>
                            <tr>
                                <th style="width: 25%;">Atributo a Evaluar</th>
                                <th style="width: 45%;">Escala de Medici√≥n</th>
                                <th style="width: 30%;">Observaciones/Hallazgos</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-category="design">
                                <td class="attribute-cell">
                                    <strong>¬øEl dise√±o es modular?</strong>
                                    <div class="attribute-description">Componentes con alta cohesi√≥n y bajo acoplamiento</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="1" onclick="selectOption(this)">1 - Monol√≠tico</div>
                                        <div class="scale-option" data-value="2" onclick="selectOption(this)">2 - Poco modular</div>
                                        <div class="scale-option" data-value="3" onclick="selectOption(this)">3 - Moderadamente modular</div>
                                        <div class="scale-option" data-value="4" onclick="selectOption(this)">4 - Modular</div>
                                        <div class="scale-option" data-value="5" onclick="selectOption(this)">5 - Altamente modular</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: M√≥dulo de autenticaci√≥n acoplado con m√≥dulo de pagos..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="design">
                                <td class="attribute-cell">
                                    <strong>¬øEl dise√±o sigue patrones establecidos?</strong>
                                    <div class="attribute-description">Uso de design patterns reconocidos (MVC, Repository, Factory, etc.)</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="yes" onclick="selectOption(this)">‚úì S√≠ - Sigue patrones</div>
                                        <div class="scale-option" data-value="partial" onclick="selectOption(this)">~ Parcial - Algunos patrones</div>
                                        <div class="scale-option" data-value="no" onclick="selectOption(this)">‚úó No - Sin patrones</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: Implementa MVC pero falta Repository pattern..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="design">
                                <td class="attribute-cell">
                                    <strong>¬øLa documentaci√≥n del dise√±o est√° completa?</strong>
                                    <div class="attribute-description">Diagramas UML, arquitectura, flujos de datos documentados</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="0" onclick="selectOption(this)">0% - Sin documentaci√≥n</div>
                                        <div class="scale-option" data-value="1" onclick="selectOption(this)">25% - Muy incompleta</div>
                                        <div class="scale-option" data-value="2" onclick="selectOption(this)">50% - Parcialmente completa</div>
                                        <div class="scale-option" data-value="3" onclick="selectOption(this)">75% - Mayormente completa</div>
                                        <div class="scale-option" data-value="4" onclick="selectOption(this)">100% - Completamente documentada</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: Faltan diagramas de secuencia para casos cr√≠ticos..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="design">
                                <td class="attribute-cell">
                                    <strong>¬øEl dise√±o es escalable?</strong>
                                    <div class="attribute-description">Capacidad de crecer en usuarios, datos y transacciones sin degradaci√≥n</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="1" onclick="selectOption(this)">1 - No escalable</div>
                                        <div class="scale-option" data-value="2" onclick="selectOption(this)">2 - Poco escalable</div>
                                        <div class="scale-option" data-value="3" onclick="selectOption(this)">3 - Moderadamente escalable</div>
                                        <div class="scale-option" data-value="4" onclick="selectOption(this)">4 - Escalable</div>
                                        <div class="scale-option" data-value="5" onclick="selectOption(this)">5 - Altamente escalable</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: Arquitectura preparada para escalamiento horizontal..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="design">
                                <td class="attribute-cell">
                                    <strong>Cantidad de componentes sin documentar</strong>
                                    <div class="attribute-description">Contar componentes/m√≥dulos que requieren documentaci√≥n adicional</div>
                                </td>
                                <td class="scale-cell">
                                    <input type="number" class="observation-input" placeholder="Ingrese cantidad num√©rica" style="width: 150px; min-height: 40px;" onchange="updateMetrics()">
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: AuthService, PaymentGateway, NotificationEngine..."></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- CATEGOR√çA 3: C√ìDIGO -->
            <div class="category-section">
                <div class="category-header" onclick="toggleCategory('code')">
                    <div class="category-title">
                        <span>üíª</span>
                        <span>Categor√≠a 3: Calidad de C√≥digo</span>
                    </div>
                    <div class="category-score" id="code-score">0%</div>
                </div>
                <div class="category-content" id="code-content">
                    <table class="checklist-table">
                        <thead>
                            <tr>
                                <th style="width: 25%;">Atributo a Evaluar</th>
                                <th style="width: 45%;">Escala de Medici√≥n</th>
                                <th style="width: 30%;">Observaciones/Hallazgos</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-category="code">
                                <td class="attribute-cell">
                                    <strong>¬øEl c√≥digo sigue est√°ndares de codificaci√≥n?</strong>
                                    <div class="attribute-description">Convenciones de nombrado, indentaci√≥n, comentarios seg√∫n gu√≠a del proyecto</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="1" onclick="selectOption(this)">1 - No sigue est√°ndares</div>
                                        <div class="scale-option" data-value="2" onclick="selectOption(this)">2 - Pocos est√°ndares</div>
                                        <div class="scale-option" data-value="3" onclick="selectOption(this)">3 - Cumplimiento parcial</div>
                                        <div class="scale-option" data-value="4" onclick="selectOption(this)">4 - Mayormente cumple</div>
                                        <div class="scale-option" data-value="5" onclick="selectOption(this)">5 - Cumple totalmente</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: Variables no siguen camelCase en m√≥dulo X..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="code">
                                <td class="attribute-cell">
                                    <strong>Cobertura de pruebas unitarias</strong>
                                    <div class="attribute-description">Porcentaje de l√≠neas de c√≥digo cubiertas por tests</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="0" onclick="selectOption(this)">< 40% - Insuficiente</div>
                                        <div class="scale-option" data-value="1" onclick="selectOption(this)">40-59% - Deficiente</div>
                                        <div class="scale-option" data-value="2" onclick="selectOption(this)">60-74% - Aceptable</div>
                                        <div class="scale-option" data-value="3" onclick="selectOption(this)">75-84% - Bueno</div>
                                        <div class="scale-option" data-value="4" onclick="selectOption(this)">‚â• 85% - Excelente</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: Cobertura actual: 73% seg√∫n SonarQube..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="code">
                                <td class="attribute-cell">
                                    <strong>¬øEl c√≥digo tiene comentarios adecuados?</strong>
                                    <div class="attribute-description">Documentaci√≥n inline clara, JSDoc/Javadoc presente donde necesario</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="yes" onclick="selectOption(this)">‚úì S√≠ - Bien comentado</div>
                                        <div class="scale-option" data-value="partial" onclick="selectOption(this)">~ Parcial - Algunos comentarios</div>
                                        <div class="scale-option" data-value="no" onclick="selectOption(this)">‚úó No - Sin comentarios</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: Funciones complejas sin explicaci√≥n de l√≥gica..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="code">
                                <td class="attribute-cell">
                                    <strong>Complejidad ciclom√°tica</strong>
                                    <div class="attribute-description">Evaluaci√≥n de la complejidad de m√©todos/funciones seg√∫n McCabe</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="4" onclick="selectOption(this)">1-10 - Baja (Excelente)</div>
                                        <div class="scale-option" data-value="3" onclick="selectOption(this)">11-20 - Moderada (Buena)</div>
                                        <div class="scale-option" data-value="2" onclick="selectOption(this)">21-50 - Alta (Refactorizar)</div>
                                        <div class="scale-option" data-value="1" onclick="selectOption(this)">51+ - Muy alta (Cr√≠tico)</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: M√©todo processPayment() tiene CC de 35..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="code">
                                <td class="attribute-cell">
                                    <strong>Cantidad de code smells detectados</strong>
                                    <div class="attribute-description">Contar problemas de mantenibilidad seg√∫n an√°lisis est√°tico (SonarQube)</div>
                                </td>
                                <td class="scale-cell">
                                    <input type="number" class="observation-input" placeholder="Ingrese cantidad num√©rica" style="width: 150px; min-height: 40px;" onchange="updateMetrics()">
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: 23 code smells: duplicaci√≥n de c√≥digo, m√©todos muy largos..."></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- CATEGOR√çA 4: PRUEBAS -->
            <div class="category-section">
                <div class="category-header" onclick="toggleCategory('testing')">
                    <div class="category-title">
                        <span>üß™</span>
                        <span>Categor√≠a 4: Calidad de Pruebas</span>
                    </div>
                    <div class="category-score" id="testing-score">0%</div>
                </div>
                <div class="category-content" id="testing-content">
                    <table class="checklist-table">
                        <thead>
                            <tr>
                                <th style="width: 25%;">Atributo a Evaluar</th>
                                <th style="width: 45%;">Escala de Medici√≥n</th>
                                <th style="width: 30%;">Observaciones/Hallazgos</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-category="testing">
                                <td class="attribute-cell">
                                    <strong>¬øLos casos de prueba est√°n completos?</strong>
                                    <div class="attribute-description">Cubren todos los requerimientos funcionales y no funcionales</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="0" onclick="selectOption(this)">0-25% - Muy incompleto</div>
                                        <div class="scale-option" data-value="1" onclick="selectOption(this)">26-50% - Incompleto</div>
                                        <div class="scale-option" data-value="2" onclick="selectOption(this)">51-75% - Parcialmente completo</div>
                                        <div class="scale-option" data-value="3" onclick="selectOption(this)">76-90% - Mayormente completo</div>
                                        <div class="scale-option" data-value="4" onclick="selectOption(this)">91-100% - Completamente completo</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: Falta cobertura de casos de error en API REST..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="testing">
                                <td class="attribute-cell">
                                    <strong>¬øLos casos de prueba son ejecutables?</strong>
                                    <div class="attribute-description">Tienen datos de prueba, pre-condiciones y pasos claros</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="yes" onclick="selectOption(this)">‚úì S√≠ - Todos ejecutables</div>
                                        <div class="scale-option" data-value="partial" onclick="selectOption(this)">~ Parcial - Algunos ejecutables</div>
                                        <div class="scale-option" data-value="no" onclick="selectOption(this)">‚úó No - No ejecutables</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: Casos TC-045 a TC-067 sin datos de prueba..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="testing">
                                <td class="attribute-cell">
                                    <strong>Porcentaje de casos de prueba automatizados</strong>
                                    <div class="attribute-description">Nivel de automatizaci√≥n de la suite de pruebas</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="0" onclick="selectOption(this)">0% - Sin automatizaci√≥n</div>
                                        <div class="scale-option" data-value="1" onclick="selectOption(this)">1-25% - Baja automatizaci√≥n</div>
                                        <div class="scale-option" data-value="2" onclick="selectOption(this)">26-50% - Media automatizaci√≥n</div>
                                        <div class="scale-option" data-value="3" onclick="selectOption(this)">51-75% - Alta automatizaci√≥n</div>
                                        <div class="scale-option" data-value="4" onclick="selectOption(this)">76-100% - Muy alta automatizaci√≥n</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: 45% automatizado con Cypress y Jest..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="testing">
                                <td class="attribute-cell">
                                    <strong>Tasa de detecci√≥n de defectos</strong>
                                    <div class="attribute-description">Efectividad de las pruebas en encontrar defectos reales</div>
                                </td>
                                <td class="scale-cell">
                                    <div class="scale-options">
                                        <div class="scale-option" data-value="1" onclick="selectOption(this)">< 40% - Baja efectividad</div>
                                        <div class="scale-option" data-value="2" onclick="selectOption(this)">40-59% - Media efectividad</div>
                                        <div class="scale-option" data-value="3" onclick="selectOption(this)">60-79% - Buena efectividad</div>
                                        <div class="scale-option" data-value="4" onclick="selectOption(this)">‚â• 80% - Excelente efectividad</div>
                                    </div>
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: 67% de defectos encontrados en testing vs producci√≥n..."></textarea>
                                </td>
                            </tr>
                            <tr data-category="testing">
                                <td class="attribute-cell">
                                    <strong>Cantidad de defectos bloqueantes encontrados</strong>
                                    <div class="attribute-description">Contar defectos cr√≠ticos que impiden continuar las pruebas</div>
                                </td>
                                <td class="scale-cell">
                                    <input type="number" class="observation-input" placeholder="Ingrese cantidad num√©rica" style="width: 150px; min-height: 40px;" onchange="updateMetrics()">
                                </td>
                                <td class="observation-cell">
                                    <textarea class="observation-input" placeholder="Ej: 3 defectos bloqueantes: DEF-012, DEF-034, DEF-089..."></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Botones de Navegaci√≥n -->
            <div class="nav-buttons">
                <button onclick="window.location.href='dashboard_calidad_ibm.html'" class="btn btn-secondary">‚Üê Dashboard Calidad</button>
                <button onclick="saveChecklist()" class="btn btn-success">üíæ Guardar Evaluaci√≥n</button>
                <button onclick="exportChecklist()" class="btn btn-primary">üìä Exportar JSON</button>
                <button onclick="exportChecklistTXT()" class="btn btn-primary">üìÑ Exportar TXT</button>
                <button onclick="window.print()" class="btn btn-primary">üñ®Ô∏è Imprimir/PDF</button>
            </div>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'ibm_qms_quality_checklist';

        window.addEventListener('DOMContentLoaded', () => {
            loadChecklist();
            updateMetrics();
        });

        function toggleCategory(categoryId) {
            const content = document.getElementById(`${categoryId}-content`);
            content.classList.toggle('active');
        }

        function selectOption(element) {
            // Desmarcar hermanos
            const siblings = element.parentElement.querySelectorAll('.scale-option');
            siblings.forEach(s => s.classList.remove('selected'));
            
            // Marcar seleccionado
            element.classList.add('selected');
            
            // Actualizar m√©tricas
            updateMetrics();
            
            // Auto-save
            saveChecklist();
        }

        function updateMetrics() {
            // Contar selecciones
            const totalRows = document.querySelectorAll('tbody tr').length;
            const selectedRows = document.querySelectorAll('.scale-option.selected').length;
            const numberInputs = document.querySelectorAll('input[type="number"]');
            
            // Calcular defectos
            let totalDefects = 0;
            numberInputs.forEach(input => {
                totalDefects += parseInt(input.value) || 0;
            });
            
            // Calcular puntaje promedio
            let totalScore = 0;
            let scoreCount = 0;
            document.querySelectorAll('.scale-option.selected').forEach(opt => {
                const value = parseInt(opt.dataset.value);
                if (!isNaN(value)) {
                    totalScore += value;
                    scoreCount++;
                }
            });
            const avgScore = scoreCount > 0 ? (totalScore / scoreCount).toFixed(1) : 0;
            
            // Calcular calidad global (basado en promedio normalizado a 100%)
            const globalQuality = scoreCount > 0 ? Math.round((totalScore / (scoreCount * 5)) * 100) : 0;
            
            // Actualizar UI
            document.getElementById('total-score').textContent = `${globalQuality}%`;
            document.getElementById('completed-attrs').textContent = selectedRows;
            document.getElementById('defects-count').textContent = totalDefects;
            document.getElementById('avg-score').textContent = avgScore;
            
            // Actualizar por categor√≠a
            ['requirements', 'design', 'code', 'testing'].forEach(cat => {
                const catRows = document.querySelectorAll(`tr[data-category="${cat}"]`);
                let catScore = 0;
                let catCount = 0;
                
                catRows.forEach(row => {
                    const selected = row.querySelector('.scale-option.selected');
                    if (selected) {
                        const value = parseInt(selected.dataset.value);
                        if (!isNaN(value)) {
                            catScore += value;
                            catCount++;
                        }
                    }
                });
                
                const catPercentage = catCount > 0 ? Math.round((catScore / (catCount * 5)) * 100) : 0;
                document.getElementById(`${cat}-score`).textContent = `${catPercentage}%`;
            });
        }

        function saveChecklist() {
            const data = {
                timestamp: new Date().toISOString(),
                selections: [],
                observations: [],
                numberInputs: []
            };
            
            // Guardar selecciones
            document.querySelectorAll('.scale-option.selected').forEach(opt => {
                const row = opt.closest('tr');
                const attr = row.querySelector('.attribute-cell strong').textContent;
                data.selections.push({
                    attribute: attr,
                    value: opt.dataset.value,
                    text: opt.textContent.trim()
                });
            });
            
            // Guardar observaciones
            document.querySelectorAll('.observation-input').forEach((input, idx) => {
                if (input.value.trim()) {
                    data.observations.push({
                        index: idx,
                        value: input.value
                    });
                }
            });
            
            // Guardar n√∫meros
            document.querySelectorAll('input[type="number"]').forEach((input, idx) => {
                if (input.value) {
                    data.numberInputs.push({
                        index: idx,
                        value: input.value
                    });
                }
            });
            
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            alert('‚úÖ Evaluaci√≥n guardada exitosamente');
        }

        function loadChecklist() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (!saved) return;
            
            const data = JSON.parse(saved);
            
            // Restaurar selecciones
            data.selections?.forEach(sel => {
                const rows = document.querySelectorAll('tbody tr');
                rows.forEach(row => {
                    const attr = row.querySelector('.attribute-cell strong')?.textContent;
                    if (attr === sel.attribute) {
                        const option = Array.from(row.querySelectorAll('.scale-option'))
                            .find(opt => opt.dataset.value === sel.value);
                        if (option) {
                            option.classList.add('selected');
                        }
                    }
                });
            });
            
            // Restaurar observaciones
            const observations = document.querySelectorAll('.observation-input');
            data.observations?.forEach(obs => {
                if (observations[obs.index]) {
                    observations[obs.index].value = obs.value;
                }
            });
            
            // Restaurar n√∫meros
            const numberInputs = document.querySelectorAll('input[type="number"]');
            data.numberInputs?.forEach(num => {
                if (numberInputs[num.index]) {
                    numberInputs[num.index].value = num.value;
                }
            });
            
            updateMetrics();
        }

        function exportChecklist() {
            const report = {
                fecha: new Date().toLocaleString('es-CO'),
                metricas: {
                    calidadGlobal: document.getElementById('total-score').textContent,
                    atributosEvaluados: document.getElementById('completed-attrs').textContent,
                    defectosIdentificados: document.getElementById('defects-count').textContent,
                    puntajePromedio: document.getElementById('avg-score').textContent
                },
                categorias: {
                    requerimientos: document.getElementById('requirements-score').textContent,
                    dise√±o: document.getElementById('design-score').textContent,
                    c√≥digo: document.getElementById('code-score').textContent,
                    pruebas: document.getElementById('testing-score').textContent
                },
                evaluaciones: []
            };
            
            // Recolectar evaluaciones
            document.querySelectorAll('.scale-option.selected').forEach(opt => {
                const row = opt.closest('tr');
                const attr = row.querySelector('.attribute-cell strong').textContent;
                const obs = row.querySelector('.observation-input').value;
                
                report.evaluaciones.push({
                    atributo: attr,
                    evaluacion: opt.textContent.trim(),
                    observaciones: obs
                });
            });
            
            // Descargar JSON
            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `reporte-calidad-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert('üìä Reporte JSON exportado exitosamente');
        }

        function exportChecklistTXT() {
            // Recolectar datos
            const fecha = new Date().toLocaleString('es-CO');
            const calidadGlobal = document.getElementById('total-score').textContent;
            const atributosEvaluados = document.getElementById('completed-attrs').textContent;
            const defectosIdentificados = document.getElementById('defects-count').textContent;
            const puntajePromedio = document.getElementById('avg-score').textContent;
            
            // Puntajes por categor√≠a
            const requirements = document.getElementById('requirements-score').textContent;
            const design = document.getElementById('design-score').textContent;
            const code = document.getElementById('code-score').textContent;
            const testing = document.getElementById('testing-score').textContent;
            
            // Construir texto
            let txtContent = '';
            txtContent += '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n';
            txtContent += '                 REPORTE DE LISTA DE CHEQUEO DE CALIDAD                \n';
            txtContent += '                     IBM Quality Management System                      \n';
            txtContent += '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n';
            
            txtContent += `Fecha de Generaci√≥n: ${fecha}\n`;
            txtContent += `Conforme a: CMMI Level 3, TMMi Level 3, IEEE 829, ISO/IEC 25010\n\n`;
            
            txtContent += '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n';
            txtContent += '                         M√âTRICAS GLOBALES                              \n';
            txtContent += '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n';
            
            txtContent += `  üìä Calidad Global:              ${calidadGlobal}\n`;
            txtContent += `  ‚úì  Atributos Evaluados:         ${atributosEvaluados}\n`;
            txtContent += `  üêõ Defectos Identificados:      ${defectosIdentificados}\n`;
            txtContent += `  üìà Puntaje Promedio:            ${puntajePromedio}\n\n`;
            
            txtContent += '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n';
            txtContent += '                      PUNTAJES POR CATEGOR√çA                            \n';
            txtContent += '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n';
            
            txtContent += `  üìã Requerimientos:              ${requirements}\n`;
            txtContent += `  üé® Dise√±o:                      ${design}\n`;
            txtContent += `  üíª C√≥digo:                      ${code}\n`;
            txtContent += `  üß™ Pruebas:                     ${testing}\n\n`;
            
            txtContent += '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n';
            txtContent += '                        EVALUACIONES DETALLADAS                         \n';
            txtContent += '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n';
            
            // Recolectar evaluaciones por categor√≠a
            const categories = [
                { id: 'requirements', title: 'üìã CATEGOR√çA: REQUERIMIENTOS' },
                { id: 'design', title: 'üé® CATEGOR√çA: DISE√ëO' },
                { id: 'code', title: 'üíª CATEGOR√çA: C√ìDIGO' },
                { id: 'testing', title: 'üß™ CATEGOR√çA: PRUEBAS' }
            ];
            
            categories.forEach(category => {
                txtContent += `\n${category.title}\n`;
                txtContent += '‚îÄ'.repeat(75) + '\n\n';
                
                const categorySection = document.getElementById(`${category.id}-content`);
                const rows = categorySection.querySelectorAll('tbody tr');
                
                let evalCount = 1;
                rows.forEach(row => {
                    const attrLabel = row.querySelector('.attribute-cell strong');
                    const attrDesc = row.querySelector('.attribute-cell').textContent.split('\n')[1]?.trim();
                    const selectedOption = row.querySelector('.scale-option.selected');
                    const observation = row.querySelector('.observation-input');
                    const numberInput = row.querySelector('input[type="number"]');
                    
                    if (attrLabel) {
                        txtContent += `${evalCount}. ${attrLabel.textContent}\n`;
                        
                        if (attrDesc) {
                            txtContent += `   Descripci√≥n: ${attrDesc}\n`;
                        }
                        
                        if (selectedOption) {
                            txtContent += `   ‚úì Evaluaci√≥n: ${selectedOption.textContent.trim()}\n`;
                        } else if (numberInput && numberInput.value) {
                            txtContent += `   ‚úì Cantidad: ${numberInput.value}\n`;
                        } else {
                            txtContent += `   ‚ö† Evaluaci√≥n: NO EVALUADO\n`;
                        }
                        
                        if (observation && observation.value.trim()) {
                            txtContent += `   üìù Observaciones: ${observation.value.trim()}\n`;
                        }
                        
                        txtContent += '\n';
                        evalCount++;
                    }
                });
            });
            
            txtContent += '\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n';
            txtContent += '                           FIN DEL REPORTE                              \n';
            txtContent += '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n';
            
            // Descargar TXT
            const blob = new Blob([txtContent], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Reporte_Lista_Chequeo_Calidad_${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert('üìÑ Reporte TXT exportado exitosamente');
        }

        // ==========================================
        // SINCRONIZACI√ìN EN TIEMPO REAL
        // ==========================================
        
        // Escuchar cambios de localStorage desde otras pesta√±as/ventanas
        window.addEventListener('storage', function(e) {
            if (e.key === STORAGE_KEY && e.newValue) {
                console.log('üîÑ Detectado cambio desde otra sesi√≥n. Recargando datos...');
                
                // Mostrar notificaci√≥n
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 80px;
                    right: 20px;
                    background: #0f62fe;
                    color: white;
                    padding: 16px 24px;
                    border-radius: 4px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                    z-index: 10000;
                    font-family: 'IBM Plex Sans', sans-serif;
                    font-size: 14px;
                    animation: slideIn 0.3s ease-out;
                `;
                notification.innerHTML = 'üîÑ Lista actualizada por otro usuario';
                document.body.appendChild(notification);
                
                // Recargar datos
                loadChecklist();
                updateMetrics();
                
                // Remover notificaci√≥n
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease-in';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            }
        });

        // Agregar estilos para animaci√≥n de notificaci√≥n
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @keyframes slideOut {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Auto-sync cada 30 segundos
        setInterval(() => {
            const lastModified = localStorage.getItem(STORAGE_KEY + '_timestamp');
            if (lastModified) {
                const timeDiff = Date.now() - parseInt(lastModified);
                
                // Si han pasado menos de 5 segundos desde la √∫ltima modificaci√≥n
                // y no fue en esta ventana, recargar
                if (timeDiff < 5000 && !window.justSaved) {
                    console.log('üîÑ Auto-sync: Recargando datos recientes...');
                    loadChecklist();
                    updateMetrics();
                }
            }
            
            window.justSaved = false;
        }, 30000); // Cada 30 segundos

        // Modificar saveChecklist para agregar timestamp
        const originalSaveChecklist = saveChecklist;
        saveChecklist = function() {
            window.justSaved = true;
            localStorage.setItem(STORAGE_KEY + '_timestamp', Date.now().toString());
            originalSaveChecklist();
        };

        console.log('‚úÖ Lista de Chequeo de Calidad - IBM QMS');
        console.log('‚úÖ Sincronizaci√≥n en tiempo real habilitada');
        console.log('Conforme a CMMI Level 3, TMMi Level 3, IEEE 829, ISO/IEC 25010');
    </script>
</body>
</html>
